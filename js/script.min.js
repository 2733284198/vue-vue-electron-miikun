function getMarkedValue(e){return e=stripScriptTag(e),marked(e)}function keyup(e,t,n){var a=getMarkedValue(e.value);countResultText(a,n),t.innerHTML=a,Prism.highlightAll()}function stripScriptTag(e){for(var t=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;t.test(e);)e=e.replace(t,"");return e}function countResultText(e,t){t.innerHTML=e.length}function togglePreview(e){var t=document.getElementsByClassName("preview-side")[0],n=document.getElementsByClassName("editor-side")[0],a=e.classList;"none"==t.style.display?(t.style.display="",n.style.width="",a.remove("octicon-chevron-left"),a.add("octicon-chevron-right")):(t.style.display="none",n.style.width="100%",a.remove("octicon-chevron-right"),a.add("octicon-chevron-left"))}function save(e,t,n){confirm("Save?")&&(saveStorage(e),keyup(e,t,n))}function clear(e,t,n){confirm("Clear?")&&(e.value="",clearStorage(),keyup(e,t,n))}function saveStorage(e){localStorage.setItem("markunVal",e.value)}function loadStorage(e){e.innerHTML=localStorage.getItem("markunVal")}function clearStorage(){localStorage.removeItem("markunVal")}window.onload=function(){"use strict";var e=document.getElementById("editor"),t=document.getElementById("result"),n=document.getElementById("modal"),a=document.getElementById("export"),o=document.getElementById("chara-count"),r=document.getElementsByClassName("btn-save")[0],i=document.getElementsByClassName("btn-clear")[0],c=document.getElementsByClassName("btn-export")[0],l=document.getElementsByClassName("btn-toggle")[0];loadStorage(e),window.setInterval(function(){saveStorage(e)},6e4);var s=window.CodeMirror.fromTextArea(e,{mode:{name:"markdown",highlightFormatting:!0},theme:"markdown",autofocus:!0,lineNumbers:!0,indentUnit:4,tabSize:2,electricChars:!0,styleActiveLine:!0,matchBrackets:!0,lineWrapping:!0,extraKeys:{Enter:"newlineAndIndentContinueMarkdownList"}});s.on("change",function(t){var n=document.createEvent("HTMLEvents");n.initEvent("change",!0,!1),e.dispatchEvent(n),e.value=s.getValue()}),e.addEventListener("change",function(){console.log("change"),keyup(e,t,o)},!1),window.marked.setOptions({langPrefix:"language-",breaks:!0}),e.value&&keyup(e,t,o),r.addEventListener("click",function(){save(e,t,o)},!1),i.addEventListener("click",function(){clear(e,t,o)},!1),c.addEventListener("click",function(){a.value=getMarkedValue(e.value),n.style.display="block"},!1),a.addEventListener("focus",function(){a.select()},!1),l.addEventListener("click",function(e){togglePreview(e.target)},!1),window.addEventListener("click",function(e){e.target==n&&(n.style.display="none")},!1)};