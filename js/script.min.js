window.onload=function(){var a=document.getElementById("editor"),b=document.getElementById("result"),c=document.getElementById("modal"),e=document.getElementById("export"),d=document.getElementById("chara-count"),h=document.getElementsByClassName("btn-save")[0],k=document.getElementsByClassName("btn-clear")[0],l=document.getElementsByClassName("btn-export")[0],m=document.getElementsByClassName("btn-toggle")[0],f=null,g=a.value;window.editor=new Behave({textarea:a,replaceTab:!0,softTabs:!0,tabSize:4,
autoOpen:!0,overwrite:!0,autoStrip:!0,autoIndent:!0,fence:!1});loadStorage(a);window.setInterval(function(){saveStorage(a)},6E4);marked.setOptions({langPrefix:"language-",breaks:!0});keyup(a,b,d);a.value&&keyup(a,b,d);a.addEventListener("focus",function(){window.clearInterval(f);f=window.setInterval(function(){var c=a.value;g!=a.value&&keyup(a,b,d);g=c},1E3)},!1);a.addEventListener("blur",function(){keyup(a,b,d)},!1);h.addEventListener("click",function(){confirm("Save?")&&(saveStorage(a),keyup(a,
b,d))},!1);k.addEventListener("click",function(){confirm("Clear?")&&(a.value="",clearStorage(),keyup(a,b,d))},!1);l.addEventListener("click",function(){e.value=getMarkedValue(a.value);c.style.display="block"},!1);e.addEventListener("focus",function(){e.select()},!1);m.addEventListener("click",function(a){togglePreview(a.target)},!1);window.addEventListener("click",function(a){a.target==c&&(c.style.display="none")},!1)};function getMarkedValue(a){a=stripScriptTag(a);return marked(a)}
function keyup(a,b,c){a=getMarkedValue(a.value);countResultText(a,c);b.innerHTML=a;Prism.highlightAll()}function stripScriptTag(a){for(var b=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;b.test(a);)a=a.replace(b,"");return a}function countResultText(a,b){b.innerHTML=a.length}
function togglePreview(a){var b=document.getElementsByClassName("preview-side")[0],c=document.getElementsByClassName("editor-side")[0];a=a.getElementsByClassName("octicon")[0];"none"==b.style.display?(b.style.display="",c.style.width="",a.classList.remove("octicon-chevron-left"),a.classList.add("octicon-chevron-right")):(b.style.display="none",c.style.width="100%",a.classList.remove("octicon-chevron-right"),a.classList.add("octicon-chevron-left"))}
function saveStorage(a){localStorage.setItem("markunVal",a.value)}function loadStorage(a){a.innerHTML=localStorage.getItem("markunVal")}function clearStorage(){localStorage.removeItem("markunVal")};
