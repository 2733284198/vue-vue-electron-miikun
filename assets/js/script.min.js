function initPlugin(){var e=require("textlint-rule-max-ten"),t=require("textlint-rule-no-doubled-joshi"),n=require("textlint-rule-no-mix-dearu-desumasu"),i=require("textlint-rule-no-double-negative-ja"),o=require("textlint-rule-incremental-headers"),r=require("textlint-rule-no-doubled-conjunction"),a=require("textlint-rule-max-appearence-count-of-words"),l=require("textlint-rule-no-doubled-conjunctive-particle-ga");window.cm=window.CodeMirror.fromTextArea(window.editor,{mode:{name:"markdown",highlightFormatting:!0},theme:"markdown",autofocus:!0,lineNumbers:!0,indentUnit:4,tabSize:2,electricChars:!0,styleActiveLine:!0,matchBrackets:!0,lineWrapping:!0,dragDrop:!1,autoCloseBrackets:!0,extraKeys:{Enter:"newlineAndIndentContinueMarkdownList"},gutters:["CodeMirror-lint-markers"],lint:{getAnnotations:createValidator({rules:{"max-ten":e,"no-doubled-joshi":t,"no-mix-dearu-desumasu":n,"no-double-negative-ja":i,"no-doubled-conjunction":r,"incremental-headers":o["default"],"no-doubled-conjunctive-particle-ga":l,"textlint-rule-max-appearence-count-of-words":a}}),async:!0}}),window.cm.on("change",function(e){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),window.editor.dispatchEvent(t)}),window.cm.on("keydown",function(e){window.editor.value=cm.getValue(),MODIFY||(MODIFY=!0)}),window.md=window.markdownit({html:!0,xhtmlOut:!1,breaks:!0,langPrefix:"language-",linkify:!1,typographer:!0})}function getMarkedValue(e){return e=stripScriptTag(e),window.md.render(e)}function setPreview(){var e=getMarkedValue(window.editor.value);setTextCount(e),window.result.innerHTML=e,Prism.highlightAll()}function stripScriptTag(e){for(var t=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;t.test(e);)e=e.replace(t,"");return e}function setTextCount(e){var t=document.getElementById("chara-count");t.innerHTML=e.length}function showHTML(){var e=document.getElementsByClassName("btn-preview")[0];e.addEventListener("click",function(){var e=window.editor.value;if(e){var t=getMarkedValue(e);basicModal.show({body:'<textarea id="export" onclick="this.select(0,this.value.length);">'+t+"</textarea>",buttons:{action:{title:"Close",fn:basicModal.close}}})}},!1)}function togglePreview(e){var t=document.getElementsByClassName("preview-side")[0],n=document.getElementsByClassName("editor-side")[0],i=e.classList;"none"==t.style.display?(t.style.display="",n.style.width="",i.remove("octicon-chevron-left"),i.add("octicon-chevron-right")):(t.style.display="none",n.style.width="100%",i.remove("octicon-chevron-right"),i.add("octicon-chevron-left"))}function save(){window.confirm("Save?")&&(saveStorage(window.editor.value),setPreview())}function clear(){window.confirm("Clear?")&&(cm.getDoc().setValue(""),window.editor.value="",clearStorage(),setPreview())}function saveStorage(e){localStorage.setItem(STORAGE_KEYNAME,e)}function loadStorage(e){e.innerHTML=localStorage.getItem(STORAGE_KEYNAME)}function clearStorage(){localStorage.removeItem(STORAGE_KEYNAME)}var STORAGE_KEYNAME="MiiKun",createValidator=require("codemirror-textlint");window.onload=function(){"use strict";window.editor=document.getElementById("editor"),window.result=document.getElementById("result"),initPlugin(),editor.addEventListener("change",function(){setPreview()},!1),editor.value&&setPreview(),showHTML();var e=document.getElementsByClassName("btn-toggle")[0];e.addEventListener("click",function(e){togglePreview(e.target)},!1)};